<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HIdentity</title>
  <style>
    :root {
      --bg: #121212;
      --card-bg: #1e1e1e;
      --primary: #4fc3f7;
      --primary-hover: #29b8f2;
      --success: #66bb6a;
      --success-hover: #57a155;
      --text: #e0e0e0;
      --text-secondary: #9e9e9e;
      --border: #333;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Segoe UI', system-ui, sans-serif;
      line-height: 1.6;
      padding: 20px;
      max-width: 700px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin: 24px 0 16px;
    }

    .animated-title {
      font-size: 2.4em;
      font-weight: 800;
      background: linear-gradient(90deg, #ff00cc, #00ccff, #ff00cc);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 4px;
      animation: gradientShift 3s ease-in-out infinite;
      text-shadow: 0 0 10px rgba(0, 204, 255, 0.5);
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .subtitle {
      color: #4fc3f7; /* azzurro scuro */
      font-size: 1.05em;
      font-weight: 500;
      margin-bottom: 12px;
    }

    .platforms {
      text-align: center;
      color: var(--text-secondary);
      font-size: 0.95em;
      margin: 14px 0;
    }

    textarea {
      width: 100%;
      min-height: 100px;
      padding: 16px;
      margin: 14px 0;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text);
      font-size: 16px;
      resize: vertical;
      outline: none;
    }

    textarea:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(79, 195, 247, 0.2);
    }

    button {
      width: 100%;
      padding: 14px;
      font-size: 17px;
      font-weight: 600;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.2s;
    }

    #cleanBtn {
      background: var(--primary);
      color: #000;
    }

    #cleanBtn:hover {
      background: var(--primary-hover);
    }

    #copyBtn {
      background: var(--success);
      color: #000;
      margin-top: 16px;
      display: none;
    }

    #copyBtn:hover {
      background: var(--success-hover);
    }

    .result {
      margin-top: 20px;
      padding: 16px;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      word-break: break-all;
      font-family: monospace;
      font-size: 15px;
      display: none;
    }

    .footer {
      text-align: center;
      margin-top: 32px;
      color: var(--text-secondary);
      font-size: 0.85em;
      padding-top: 20px;
      border-top: 1px solid var(--border);
    }

    @media (max-width: 600px) {
      .animated-title {
        font-size: 2em;
      }
      body {
        padding: 16px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="animated-title">HIdentity</div>
    <p class="subtitle">/Dev/IceDMG</p>
    <div class="platforms">
      <strong>Supportati:</strong> Instagram â€¢ TikTok â€¢ Facebook â€¢ YouTube
    </div>
  </header>

  <textarea id="inputUrl" placeholder="Incolla qui il link da Instagram, TikTok, Facebook o YouTube..."></textarea>
  <button id="cleanBtn" onclick="cleanUrl()">Pulisci il link</button>

  <div id="result" class="result"></div>
  <button id="copyBtn" onclick="copyResult()">Copia link pulito</button>

  <div class="footer">
    ðŸ”’ Nessun dato verrÃ  tracciato. Tutto avviene nel browser.
  </div>

  <script>
    const CLEANING_RULES = {
      instagram: {
        hostIncludes: ['instagram.com'],
        removeParams: [
          'igsh', 'igshid', 'ig_rid', '_nc_*', 'efg', 'oh', 'oe', 's', 'sh', 't', 'hash',
          'attribution_id', 'fbclid', 'utm_*'
        ]
      },
      tiktok: {
        hostIncludes: ['tiktok.com'],
        removeParams: [
          '_r', 'ttclid', 'refer', 'is_from_webapp', 'sender_device', 'sender_web_id',
          'web_id', 'device_id', 'language', 'source', 'sec_uid', 'share_app_id',
          'share_item_id', 'share_link_id', 'utm_*', 'fbclid'
        ]
      },
      facebook: {
        hostIncludes: ['facebook.com', 'fb.com'],
        removeParams: [
          'fbclid', 'ref', '__tn__', 'fref', 'refsrc', 'hc_location', 'pnref', 'eid',
          'sid', 'gs_l', 'cmp', 'mibextid', 'rdid', 'share_source', 'utm_*'
        ]
      },
      youtube: {
        hostIncludes: ['youtube.com', 'youtu.be'],
        removeParams: [
          'si', 'feature', 't', 'pp', 'vq', 'cbrd', 'gws_rd', 'hl', 'gl', 'disable_polymer',
          'bpctr', 'pbj', 'ucbcb', 'has_verified', 'embeds_referring_euri',
          'utm_*', 'fbclid'
        ]
      }
    };

    function getPlatform(url) {
      const host = url.hostname.toLowerCase();
      for (const [platform, rules] of Object.entries(CLEANING_RULES)) {
        if (rules.hostIncludes.some(part => host.includes(part))) {
          return platform;
        }
      }
      return 'generic';
    }

    function cleanUrl() {
      const input = document.getElementById('inputUrl').value.trim();
      if (!input) {
        alert('âš ï¸ Inserisci un link.');
        return;
      }

      try {
        let urlInput = input;
        if (!urlInput.match(/^https?:\/\//)) {
          urlInput = 'https://' + urlInput;
        }
        const url = new URL(urlInput);
        const platform = getPlatform(url);
        const params = new URLSearchParams(url.search);
        let removeList = [];

        if (platform !== 'generic') {
          removeList = CLEANING_RULES[platform].removeParams;
        } else {
          removeList = ['utm_*', 'fbclid', 'gclid', 'yclid', 'ref', 'source'];
        }

        for (const rule of removeList) {
          if (rule.endsWith('_*')) {
            const prefix = rule.slice(0, -2);
            for (const key of Array.from(params.keys())) {
              if (key.startsWith(prefix)) {
                params.delete(key);
              }
            }
          } else {
            params.delete(rule);
          }
        }

        url.search = params.toString();
        const clean = url.toString();

        const resultEl = document.getElementById('result');
        resultEl.textContent = clean;
        resultEl.style.display = 'block';
        document.getElementById('copyBtn').style.display = 'block';
      } catch (e) {
        alert('âš ï¸ URL non valido. Assicurati che inizi con "https://".');
      }
    }

    function copyResult() {
      const text = document.getElementById('result').textContent;
      if (!text) return;

      navigator.clipboard.writeText(text).then(() => {
        const btn = document.getElementById('copyBtn');
        const original = btn.textContent;
        btn.textContent = 'âœ… Copiato!';
        setTimeout(() => {
          btn.textContent = original;
        }, 1500);
      }).catch(() => {
        prompt('Copia manualmente:', text);
      });
    }
  </script>
</body>
</html>

